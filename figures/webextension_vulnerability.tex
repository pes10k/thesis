\begin{figure}[t!]
  \centering
  \lstset{numbers=left,xleftmargin=2em,frame=single,framexleftmargin=1.5em}
  \begin{lstlisting}[language=javascript]
  // Overwrite the "toBlob" method on canvas objects in
  // this frame.
  window.HTMLCanvasElement.prototype.toBlob = () => "blocked";

  let canvasElm = document.getElementByTagName("canvas");
  canvasElm.toBlob(); // Returns "blocked".

  let childIFrame = document.createElement("iframe");
  childIFrame.location = "//" + document.location.hostName;
  document.body.appendChild(childIFrame);

  // Extract the "toBlob" method from the DOM of the child frame.
  let childWindow = childIFrame.childWindow;
  let childToBlob = childWindow.HTMLCanvasElement.prototype.toBlob;

  // Returns the contents of the canvas element as a base64 string,
  // the functionality we tried to block above.
  childToBlob.call(canvasElm);
  \end{lstlisting}
  \caption{\JS code demonstrating the discovered WebExtension vulnerability.}
  \label{fig:webex-vulnerability-js}
\end{figure}
